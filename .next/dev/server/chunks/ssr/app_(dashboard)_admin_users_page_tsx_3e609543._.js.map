{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/vs%20code/antigravity%20related%20test%20projects/react%20dashboard%20project/admin-dashboard-type2/app/%28dashboard%29/admin/users/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Table, Button, Tag, Card, Typography, App, Space } from 'antd';\r\nimport { ReloadOutlined } from '@ant-design/icons';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nconst { Title, Text } = Typography;\r\n\r\ninterface User {\r\n  id: string;\r\n  email: string;\r\n  role: string;\r\n  status: string;\r\n  created_at: string;\r\n}\r\n\r\nexport default function UsersPage() {\r\n  const router = useRouter();\r\n  const { message } = App.useApp();\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const fetchUsers = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch('/api/admin/users');\r\n      if (res.status === 401 || res.status === 403) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n      if (!res.ok) throw new Error('Failed to fetch users');\r\n      const data = await res.json();\r\n      setUsers(data);\r\n    } catch (error) {\r\n      console.error(error);\r\n      message.error('Failed to load users');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, []);\r\n\r\n  const handleApprove = async (userId: string) => {\r\n    try {\r\n      const res = await fetch(`/api/admin/users/${userId}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ status: 'approved' }),\r\n      });\r\n\r\n      if (!res.ok) throw new Error('Failed to approve user');\r\n\r\n      message.success('User approved successfully');\r\n      fetchUsers(); // Refresh list\r\n    } catch (error) {\r\n      console.error(error);\r\n      message.error('Failed to approve user');\r\n    }\r\n  };\r\n\r\n  const handleToggleRole = async (user: User) => {\r\n    const newRole = user.role === 'admin' ? 'user' : 'admin';\r\n    try {\r\n        const res = await fetch(`/api/admin/users/${user.id}`, {\r\n            method: 'PATCH',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ role: newRole }),\r\n        });\r\n\r\n        const data = await res.json();\r\n        if (!res.ok) throw new Error(data.message || 'Failed to update role');\r\n\r\n        message.success(`User role updated to ${newRole.toUpperCase()}`);\r\n        fetchUsers();\r\n    } catch (error: any) {\r\n        console.error(error);\r\n        message.error(error.message);\r\n    }\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      title: 'Email',\r\n      dataIndex: 'email',\r\n      key: 'email',\r\n      render: (text: string) => <Text strong style={{ color: 'white' }}>{text}</Text>,\r\n    },\r\n    {\r\n      title: 'Role',\r\n      dataIndex: 'role',\r\n      key: 'role',\r\n      render: (role: string) => {\r\n        const isAdmin = role === 'admin';\r\n        return (\r\n          <Tag \r\n            color={isAdmin ? 'rgba(108, 93, 211, 0.15)' : 'rgba(45, 156, 219, 0.15)'} \r\n            style={{ \r\n                color: isAdmin ? '#6C5DD3' : '#2D9CDB', \r\n                borderRadius: 8, \r\n                border: '1px solid',\r\n                borderColor: isAdmin ? 'rgba(108, 93, 211, 0.3)' : 'rgba(45, 156, 219, 0.3)',\r\n                fontWeight: 600,\r\n                fontSize: 12,\r\n                padding: '2px 10px'\r\n            }}\r\n          >\r\n             {role.toUpperCase()}\r\n          </Tag>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      title: 'Status',\r\n      dataIndex: 'status',\r\n      key: 'status',\r\n      render: (status: string) => (\r\n        <Tag color={status === 'approved' ? 'rgba(117, 255, 117, 0.1)' : 'rgba(255, 117, 76, 0.1)'} style={{ color: status === 'approved' ? '#75FF75' : '#FF754C', borderRadius: 8, border: 0 }}>\r\n          {status.toUpperCase()}\r\n        </Tag>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Action',\r\n      key: 'action',\r\n      render: (_: any, record: User) => (\r\n        <Space size=\"middle\">\r\n          {record.status === 'pending' && (\r\n            <Button type=\"primary\" size=\"small\" onClick={() => handleApprove(record.id)} style={{ borderRadius: 8 }}>\r\n              Approve\r\n            </Button>\r\n          )}\r\n          {record.email !== 'test@test.com' && (\r\n             <Button \r\n                size=\"small\" \r\n                onClick={() => handleToggleRole(record)}\r\n                style={{ \r\n                    borderRadius: 8, \r\n                    borderColor: record.role === 'admin' ? '#ff4d4f' : '#6C5DD3',\r\n                    color: record.role === 'admin' ? '#ff4d4f' : '#6C5DD3'\r\n                }}\r\n             >\r\n                {record.role === 'admin' ? 'Remove Admin' : 'Make Admin'}\r\n             </Button>\r\n          )}\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"animate-fade-up\">\r\n      <Card variant=\"borderless\" title={\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n              <Title level={4} style={{ color: 'white', margin: 0 }}>User Management</Title>\r\n              <Button icon={<ReloadOutlined />} onClick={fetchUsers} type=\"text\" style={{ color: '#808191' }}>Refresh</Button>\r\n          </div>\r\n      }>\r\n        <Table\r\n          columns={columns}\r\n          dataSource={users}\r\n          rowKey=\"id\"\r\n          loading={loading}\r\n          pagination={{ pageSize: 10 }}\r\n        />\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}