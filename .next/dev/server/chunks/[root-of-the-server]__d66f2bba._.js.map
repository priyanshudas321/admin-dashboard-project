{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 292, "column": 0}, "map": {"version":3,"sources":["file:///E:/vs%20code/antigravity%20related%20test%20projects/react%20dashboard%20project/admin-dashboard-type2/app/lib/youtubeTranscript.ts"],"sourcesContent":["import ytdl from '@distube/ytdl-core';\r\nimport axios from 'axios';\r\n\r\nexport async function getYouTubeTranscript(videoId: string): Promise<string> {\r\n  try {\r\n    console.log(`[Transcript] Fetching info for video ${videoId}...`);\r\n    const info = await ytdl.getInfo(videoId);\r\n    \r\n    const captions = info.player_response.captions?.playerCaptionsTracklistRenderer?.captionTracks;\r\n    \r\n    if (!captions || captions.length === 0) {\r\n      throw new Error('No captions found for this video.');\r\n    }\r\n\r\n    // Prefer English, but take the first available if not found\r\n    const track = captions.find((t: any) => t.languageCode === 'en') || captions[0];\r\n    const logText = track.name?.simpleText || 'Unknown';\r\n    console.log(`[Transcript] Found caption track: ${logText} (${track.languageCode})`);\r\n\r\n    // Fetch the transcript XML\r\n    const transcriptUrl = track.baseUrl as string;\r\n    if (!transcriptUrl) throw new Error('No transcript URL found');\r\n\r\n    const response = await axios.get(transcriptUrl);\r\n    const xml = response.data;\r\n\r\n    // Parse XML (simple regex parsing to avoid heavy xml libraries)\r\n    // Format: <text start=\"0.1\" dur=\"2.3\">Hello world</text>\r\n    const regex = /<text start=\"([^\"]*)\" dur=\"([^\"]*)\">([^<]*)<\\/text>/g;\r\n    let match;\r\n    let fullText = '';\r\n\r\n    while ((match = regex.exec(xml)) !== null) {\r\n      // Decode HTML entities (basic ones)\r\n      let text = match[3]\r\n        .replace(/&amp;/g, '&')\r\n        .replace(/&lt;/g, '<')\r\n        .replace(/&gt;/g, '>')\r\n        .replace(/&quot;/g, '\"')\r\n        .replace(/&#39;/g, \"'\");\r\n        \r\n      fullText += text + ' ';\r\n    }\r\n\r\n    if (!fullText.trim()) {\r\n        throw new Error('Parsed transcript is empty');\r\n    }\r\n\r\n    return fullText.trim();\r\n\r\n  } catch (error: any) {\r\n    console.error('Transcript fetch error:', error);\r\n    if (error.message.includes('No captions')) {\r\n         throw new Error('No transcript found. The video might not have captions.');\r\n    }\r\n    throw new Error(`Failed to fetch transcript: ${error.message}`);\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,qBAAqB,OAAe;IACxD,IAAI;QACF,QAAQ,GAAG,CAAC,CAAC,qCAAqC,EAAE,QAAQ,GAAG,CAAC;QAChE,MAAM,OAAO,MAAM,sKAAI,CAAC,OAAO,CAAC;QAEhC,MAAM,WAAW,KAAK,eAAe,CAAC,QAAQ,EAAE,iCAAiC;QAEjF,IAAI,CAAC,YAAY,SAAS,MAAM,KAAK,GAAG;YACtC,MAAM,IAAI,MAAM;QAClB;QAEA,4DAA4D;QAC5D,MAAM,QAAQ,SAAS,IAAI,CAAC,CAAC,IAAW,EAAE,YAAY,KAAK,SAAS,QAAQ,CAAC,EAAE;QAC/E,MAAM,UAAU,MAAM,IAAI,EAAE,cAAc;QAC1C,QAAQ,GAAG,CAAC,CAAC,kCAAkC,EAAE,QAAQ,EAAE,EAAE,MAAM,YAAY,CAAC,CAAC,CAAC;QAElF,2BAA2B;QAC3B,MAAM,gBAAgB,MAAM,OAAO;QACnC,IAAI,CAAC,eAAe,MAAM,IAAI,MAAM;QAEpC,MAAM,WAAW,MAAM,kJAAK,CAAC,GAAG,CAAC;QACjC,MAAM,MAAM,SAAS,IAAI;QAEzB,gEAAgE;QAChE,yDAAyD;QACzD,MAAM,QAAQ;QACd,IAAI;QACJ,IAAI,WAAW;QAEf,MAAO,CAAC,QAAQ,MAAM,IAAI,CAAC,IAAI,MAAM,KAAM;YACzC,oCAAoC;YACpC,IAAI,OAAO,KAAK,CAAC,EAAE,CAChB,OAAO,CAAC,UAAU,KAClB,OAAO,CAAC,SAAS,KACjB,OAAO,CAAC,SAAS,KACjB,OAAO,CAAC,WAAW,KACnB,OAAO,CAAC,UAAU;YAErB,YAAY,OAAO;QACrB;QAEA,IAAI,CAAC,SAAS,IAAI,IAAI;YAClB,MAAM,IAAI,MAAM;QACpB;QAEA,OAAO,SAAS,IAAI;IAEtB,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,2BAA2B;QACzC,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,gBAAgB;YACtC,MAAM,IAAI,MAAM;QACrB;QACA,MAAM,IAAI,MAAM,CAAC,4BAA4B,EAAE,MAAM,OAAO,EAAE;IAChE;AACF"}},
    {"offset": {"line": 343, "column": 0}, "map": {"version":3,"sources":["file:///E:/vs%20code/antigravity%20related%20test%20projects/react%20dashboard%20project/admin-dashboard-type2/app/lib/geminiAI.ts"],"sourcesContent":["import { GoogleGenerativeAI } from '@google/generative-ai';\r\n\r\n// This reads from environment variables - NEVER// Initialize Gemini API\r\nconst genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY || '');\r\n\r\nexport async function generateSummary(transcript: string): Promise<string> {\r\n  if (!process.env.GEMINI_API_KEY) {\r\n    throw new Error('GEMINI_API_KEY is not set');\r\n  }\r\n\r\n  const prompt = `\r\n    You are an expert video summarizer.\r\n    Summarize the following YouTube video transcript in a concise, bullet-point format.\r\n    Highlight the key takeaways and important details.\r\n    \r\n    Transcript:\r\n    ${transcript.substring(0, 30000)} // Limit length to avoid token limits\r\n  `;\r\n\r\n  try {\r\n    // Try Flash model first\r\n    const model = genAI.getGenerativeModel({ model: \"gemini-1.5-flash\" });\r\n    const result = await model.generateContent(prompt);\r\n    return result.response.text();\r\n  } catch (error: any) {\r\n    console.warn('Gemini 1.5 Flash failed, retrying with Gemini Pro...', error.message);\r\n    try {\r\n        // Fallback to Gemini Pro\r\n        const modelPro = genAI.getGenerativeModel({ model: \"gemini-pro\" });\r\n        const resultPro = await modelPro.generateContent(prompt);\r\n        return resultPro.response.text();\r\n    } catch (finalError: any) {\r\n        console.error('Gemini API Error:', finalError);\r\n        throw new Error(`AI Generation Failed: ${finalError.message}. Check your API Key.`);\r\n    }\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,wEAAwE;AACxE,MAAM,QAAQ,IAAI,sLAAkB,CAAC,QAAQ,GAAG,CAAC,cAAc,IAAI;AAE5D,eAAe,gBAAgB,UAAkB;IACtD,IAAI,CAAC,QAAQ,GAAG,CAAC,cAAc,EAAE;QAC/B,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,SAAS,CAAC;;;;;;IAMd,EAAE,WAAW,SAAS,CAAC,GAAG,OAAO;EACnC,CAAC;IAED,IAAI;QACF,wBAAwB;QACxB,MAAM,QAAQ,MAAM,kBAAkB,CAAC;YAAE,OAAO;QAAmB;QACnE,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;QAC3C,OAAO,OAAO,QAAQ,CAAC,IAAI;IAC7B,EAAE,OAAO,OAAY;QACnB,QAAQ,IAAI,CAAC,wDAAwD,MAAM,OAAO;QAClF,IAAI;YACA,yBAAyB;YACzB,MAAM,WAAW,MAAM,kBAAkB,CAAC;gBAAE,OAAO;YAAa;YAChE,MAAM,YAAY,MAAM,SAAS,eAAe,CAAC;YACjD,OAAO,UAAU,QAAQ,CAAC,IAAI;QAClC,EAAE,OAAO,YAAiB;YACtB,QAAQ,KAAK,CAAC,qBAAqB;YACnC,MAAM,IAAI,MAAM,CAAC,sBAAsB,EAAE,WAAW,OAAO,CAAC,qBAAqB,CAAC;QACtF;IACF;AACF"}},
    {"offset": {"line": 389, "column": 0}, "map": {"version":3,"sources":["file:///E:/vs%20code/antigravity%20related%20test%20projects/react%20dashboard%20project/admin-dashboard-type2/app/api/summarize/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { getYouTubeTranscript } from '@/app/lib/youtubeTranscript';\r\nimport { generateSummary } from '@/app/lib/geminiAI';\r\n\r\nexport async function POST(request: Request) {\r\n  try {\r\n    const { videoId } = await request.json();\r\n\r\n    if (!videoId) {\r\n      return NextResponse.json(\r\n        { error: 'Video ID is required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Check if Gemini API key is configured\r\n    if (!process.env.GEMINI_API_KEY) {\r\n      return NextResponse.json(\r\n        { error: 'Gemini API key not configured. Please add GEMINI_API_KEY to environment variables.' },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    // Get transcript\r\n    const transcript = await getYouTubeTranscript(videoId);\r\n    \r\n    // Generate AI summary\r\n    const summary = await generateSummary(transcript);\r\n    \r\n    return NextResponse.json({ \r\n      summary,\r\n      transcript_length: transcript.length\r\n    });\r\n    \r\n  } catch (error: any) {\r\n    console.error('Summarization error:', error);\r\n    return NextResponse.json(\r\n      { \r\n        error: error.message || 'Failed to summarize video',\r\n        details: 'The video might not have captions or the API key might be invalid'\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEtC,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAuB,GAChC;gBAAE,QAAQ;YAAI;QAElB;QAEA,wCAAwC;QACxC,IAAI,CAAC,QAAQ,GAAG,CAAC,cAAc,EAAE;YAC/B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAqF,GAC9F;gBAAE,QAAQ;YAAI;QAElB;QAEA,iBAAiB;QACjB,MAAM,aAAa,MAAM,IAAA,yJAAoB,EAAC;QAE9C,sBAAsB;QACtB,MAAM,UAAU,MAAM,IAAA,2IAAe,EAAC;QAEtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB;YACA,mBAAmB,WAAW,MAAM;QACtC;IAEF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO,MAAM,OAAO,IAAI;YACxB,SAAS;QACX,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}